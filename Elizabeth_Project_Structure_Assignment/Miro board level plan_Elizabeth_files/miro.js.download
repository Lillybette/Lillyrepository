var miro=(()=>{var ye=Object.defineProperty;var Le=r=>ye(r,"__esModule",{value:!0}),o=(r,e)=>ye(r,"name",{value:e,configurable:!0});var Ge=(r,e)=>{Le(r);for(var t in e)ye(r,t,{get:e[t],enumerable:!0})};var nt={};Ge(nt,{board:()=>st,clientVersion:()=>Ne});var G;(function(t){t.Success="S",t.Fail="F"})(G||(G={}));function z(){return Math.random().toString(36).slice(-10)}o(z,"generateId");function qe(r){return r instanceof ArrayBuffer||!1}o(qe,"isTransferableObject");var Ue=o((r,e)=>Object.prototype.hasOwnProperty.call(r,e),"isPropertyOf");async function ue(r){let e=[];if(r instanceof Blob)return[await r.arrayBuffer()];if(qe(r))return[r];if(typeof r!="object")return[];for(let t in r)if(Ue(r,t)){let n=r[t];if(typeof n=="object"&&n!==null){let a=await ue(n);e.push(...a)}}return e}o(ue,"getTransferable");var Ee="sdkv2-plugin-message";function Ve(r){return r.data?.commandId===Ee}o(Ve,"isPluginMessageEvent");function He(r){return r!==null&&"window"in r}o(He,"isWindow");var J=class{constructor(e){this.destroyed=!1;this.destroy=o(()=>{this.clients.forEach(e=>{e.waiting.clear()}),this.clients.clear(),this.hostWindow.removeEventListener("message",this.handlePostMessage),this.destroyed=!0},"destroy");this.createBus=o((e,t)=>{if(this.destroyed)throw new Error("SdkCommunicationBus: createBus is called on a destroyed instance");this.clients.set(e.container,{handler:t,target:e,waiting:new Map});let n=this.dispatch,{destroyBus:a}=this;return{target:e,dispatch({payload:i,msgId:p,transfer:f}){return n(e.container,i,p,f)},destroy(){return a(e.container)}}},"createBus");this.destroyBus=o(e=>{let t=this.clients.get(e);t&&(t.waiting.clear(),this.clients.delete(e))},"destroyBus");this.hostWindow=e,this.clients=new Map,this.handlePostMessage=this.handlePostMessage.bind(this),this.dispatch=this.dispatch.bind(this),this.destroyBus=this.destroyBus.bind(this),this.hostWindow.addEventListener("message",this.handlePostMessage)}handlePostMessage(e){if(!Ve(e)||!He(e.source))return;let t=this.clients.get(e.source);if(!t||t.target.origin!=="*"&&e.origin!==t.target.origin)return;let{data:n}=e,a=t.waiting.get(n.msgId);if(a)t.waiting.delete(n.msgId),a.resolve(n.payload);else{let i=o(p=>{p&&this.dispatch(t.target.container,p,n.msgId)},"after");t.handler(n.payload).then(i).catch(i)}}dispatch(e,t,n,a=[]){return new Promise((i,p)=>ue(t).then(f=>{let L=!n,P=this.clients.get(e);if(!P)return;let $;L?($=z(),P.waiting.set($,{resolve:i,reject:p})):$=n;let Be={commandId:Ee,payload:t,msgId:$},y=[...a,...f];P.target.container.postMessage(Be,P.target.origin,y),!L&&n&&(P.waiting.delete(n),i(null))}).catch(p))}};o(J,"SdkCommunicationBus");var q=class{constructor({clientWindow:e=window}){let t=new J(e);this.waitingResponse=new Map,this.handlers=new Map,this.responseHandler=this.responseHandler.bind(this),this.handle=this.handle.bind(this),this.busDispatcher=t.createBus({container:e.parent,origin:"*"},this.handle)}async exec(e,t,n=[]){let a=z(),p=[{name:e,payload:t,id:a}];return new Promise((f,L)=>{this.waitingResponse.set(a,{resolve:f,reject:L});let P={payload:p,transfer:n};this.busDispatcher.dispatch(P).then(this.responseHandler)})}responseHandler(e){let t=e;for(let n=0;n<t.length;n++){let a=t[n];if(!a)continue;let i=this.waitingResponse.get(a.id);i&&(a.status===G.Success?i.resolve(a.payload):a.status===G.Fail&&i.reject(new Error(String(a.payload))),this.waitingResponse.delete(a.id))}return Promise.resolve([])}handle(e){let t=e,n=[];for(let a=0;a<t.length;a++){let i=t[a];if(i.status){this.responseHandler([i]);continue}let p=this.handlers.get(i.id);p&&p.forEach(f=>{n.push(f(i))})}return Promise.all(n)}subscribe(e,t){let n=this.handlers.get(e)||[];this.handlers.set(e,[...n,t])}unsubscribe(e,t){let n=(this.handlers.get(e)||[]).filter(a=>a!==t);n.length===0?this.handlers.delete(e):this.handlers.set(e,n)}hasEventSubscriptions(e){return this.handlers.has(e)}};o(q,"IframeCommander");var U=class{constructor(e,t){this.realCommander=e;this.prefix=t}exec(e,t){let n=`${this.prefix.toUpperCase()}_${e}`;return this.realCommander.exec(n,t)}subscribe(e,t){this.realCommander.subscribe(e,t)}unsubscribe(e,t){this.realCommander.unsubscribe(e,t)}hasEventSubscriptions(e){return this.realCommander.hasEventSubscriptions(e)}};o(U,"CommanderProxy");var l=o((r,e,t)=>{Object.defineProperty(r,e,{enumerable:!1,writable:!1,configurable:!1,value:t})},"setPrivateField");function he(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)&&!(r instanceof Blob)}o(he,"isObject");function d(r,...e){if(!e.length)return r;let t=e.shift();return he(r)&&he(t)&&Object.keys(t).forEach(n=>{he(t[n])?(r[n]||Object.assign(r,{[n]:{}}),d(r[n],t[n])):Object.assign(r,{[n]:t[n]})}),d(r,...e)}o(d,"mergeDeep");function xe(r){let e={};return Object.keys(r).forEach(t=>{let n=r[t];typeof n!="function"&&(e[t]=n)}),e}o(xe,"asProps");var Te=o(async r=>new Promise((e,t)=>{let n=new FileReader;n.onload=()=>{e(n.result?.toString()??"")},n.onerror=()=>{t(n.error)},n.onabort=()=>{t(new Error("Aborted"))},n.readAsDataURL(r)}),"blobToDataUrl");var h=Symbol("AppManager"),s=Symbol("Commander");var w=o(async(r,e,t)=>{let n=await e.exec("WIDGET_GET",r);if(!Array.isArray(n))throw new Error("Error retrieving items");return n.map(a=>t(e,a))},"getItems");var u=class{constructor(e){l(this,s,e)}async sync(){let e=await this[s].exec("WIDGET_UPDATE",this);d(this,e)}async getMetadata(e){return this[s].exec("WIDGET_GET_METADATA",{itemId:this.id,key:e})}async setMetadata(e,t){return this[s].exec("WIDGET_SET_METADATA",{itemId:this.id,key:e,value:t})}async goToLink(){return this[s].exec("WIDGET_GO_TO_LINK",{itemId:this.id})}async bringToFront(){return this[s].exec("BRING_TO_FRONT",{items:[this.id]})}async sendToBack(){return this[s].exec("SEND_TO_BACK",{items:[this.id]})}async bringInFrontOf(e){return this[s].exec("BRING_IN_FRONT_OF",{items:[this.id],targetId:e.id})}async sendBehindOf(e){return this[s].exec("SEND_BEHIND_OF",{items:[this.id],targetId:e.id})}async getLayerIndex(){return this[s].exec("GET_LAYER_INDEX",{itemId:this.id})}async getConnectors(){let e=this.connectorIds;return!e||e.length===0?[]:w({type:"connector",id:e},this[s],g)}};o(u,"BaseItem");var _=class extends u{constructor(e,t){super(e);this.type="text";this.content="";this.style={fillColor:"transparent",fillOpacity:1,fontFamily:"arial",fontSize:14,textAlign:"left",color:"#1a1a1a"};d(this,t)}};o(_,"Text");var Pe;(function(m){m.Rectangle="rectangle",m.Circle="circle",m.Triangle="triangle",m.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",m.RoundRectangle="round_rectangle",m.Rhombus="rhombus",m.Parallelogram="parallelogram",m.Star="star",m.RightArrow="right_arrow",m.LeftArrow="left_arrow",m.Pentagon="pentagon",m.Hexagon="hexagon",m.Octagon="octagon",m.Trapezoid="trapezoid",m.FlowChartPredefinedProcess="flow_chart_predefined_process",m.LeftRightArrow="left_right_arrow",m.Cloud="cloud",m.LeftBrace="left_brace",m.RightBrace="right_brace",m.Cross="cross",m.Can="can"})(Pe||(Pe={}));var K;(function(c){c.Gray="gray",c.LightYellow="light_yellow",c.Yellow="yellow",c.Orange="orange",c.LightGreen="light_green",c.Green="green",c.DarkGreen="dark_green",c.Cyan="cyan",c.LightPink="light_pink",c.Pink="pink",c.Violet="violet",c.Red="red",c.LightBlue="light_blue",c.Blue="blue",c.DarkBlue="dark_blue",c.Black="black"})(K||(K={}));var Z;(function(y){y.Red="red",y.Magenta="magenta",y.Violet="violet",y.LightGreen="light_green",y.Green="green",y.DarkGreen="dark_green",y.Cyan="cyan",y.Blue="blue",y.DarkBlue="dark_blue",y.Yellow="yellow",y.Gray="gray",y.Black="black"})(Z||(Z={}));var I=class extends u{constructor(e,t){super(e);this.type="sticky_note";this.shape="square";this.content="";this.style={fillColor:K.LightYellow,textAlign:"center",textAlignVertical:"middle"};this.tagIds=[];d(this,t)}};o(I,"StickyNote");var D=class extends u{constructor(e,t){super(e);this.type="shape";this.content="";this.shape="rectangle";this.style={fillColor:"transparent",fontFamily:"arial",fontSize:14,textAlign:"center",textAlignVertical:"middle",borderStyle:"normal",borderOpacity:1,borderColor:"#1a1a1a",borderWidth:2,fillOpacity:1,color:"#1a1a1a"};d(this,t)}};o(D,"Shape");var x=class extends u{constructor(e,t){super(e);this.type="shape";this.content="";this.shape="rectangle";this.style={fillColor:"transparent",fontFamily:"arial",fontSize:14,textAlign:"center",textAlignVertical:"middle",borderStyle:"normal",borderOpacity:1,borderColor:"#1a1a1a",borderWidth:2,fillOpacity:1,color:"#1a1a1a"};d(this,t)}};o(x,"ShapeExperimental");var A=class extends u{constructor(e,t){super(e);this.type="image";this.title="";this.alt="";d(this,t),l(this,s,e)}async getFile(e="original"){let t={id:this.id,format:e},n=await this[s].exec("IMAGE_GET_BLOB",t);return new File([n],this.title,{lastModified:+this.modifiedAt})}async getDataUrl(e){let t=await this.getFile(e);return await Te(t)}};o(A,"Image");var S=class extends u{constructor(e,t){super(e);this.type="card";this.title="";this.description="";this.style={};this.dueDate=void 0;this.assignee=void 0;this.taskStatus="none";this.tagIds=[];this.fields=[];d(this,t)}};o(S,"Card");var R=class extends u{constructor(e,t){super(e);this.type="app_card";this.owned=!1;this.title="";this.description="";this.style={};this.tagIds=[];this.status="disconnected";this.fields=[];d(this,t)}};o(R,"AppCard");var M=class extends u{constructor(e,t){super(e);this.type="frame";this.title="";this.childrenIds=[];this.style={fillColor:"transparent"};d(this,t)}async add(e){this.childrenIds.push(e.id),await this.sync();let[t]=await w({id:e.id},this[s],b);return d(e,t),e}async remove(e){let t=e.id;if(!t)throw new Error("trying to remove a non-existent item from a frame");let n=this.childrenIds.findIndex(i=>i===t);if(n===-1)throw new Error(`Can't remove item ${t} from frame ${this.id}. The item is not a current child`);this.childrenIds.splice(n,1),await this.sync();let[a]=await w({id:e.id},this[s],b);d(e,a)}async getChildren(){let e=this.childrenIds;return e.length===0?[]:w({id:e},this[s],b)}};o(M,"Frame");var V=class extends u{constructor(e,t){super(e);this.type="unsupported";d(this,t)}};o(V,"Unsupported");var O=class extends u{constructor(e,t){super(e);this.type="preview";d(this,t)}};o(O,"Preview");var k=class extends u{constructor(e,t){super(e);this.type="embed";this.previewUrl="";this.mode="inline";d(this,t)}};o(k,"Embed");var F=class{constructor(e,t){this.type="connector";this.shape="curved";this.start=void 0;this.end=void 0;this.style={};this.captions=[];l(this,s,e),d(this,t)}async sync(){let e=await this[s].exec("WIDGET_UPDATE",this);d(this,e)}async getMetadata(e){return this[s].exec("WIDGET_GET_METADATA",{itemId:this.id,key:e})}async setMetadata(e,t){return this[s].exec("WIDGET_SET_METADATA",{itemId:this.id,key:e,value:t})}};o(F,"Connector");var We=o(r=>({type:"text",content:r.content,style:{}}),"viewTransformText"),Ye=o(r=>({type:"shape",shape:r.shape,content:r.content,style:{color:r.style.color,fillOpacity:r.style.fillOpacity,borderStyle:r.style.borderStyle}}),"viewTransformShape"),je=o(r=>r.type==="shape"?Ye(r):r.type==="text"?We(r):{},"transformNodeView"),N=class extends u{constructor(e,t){super(e);this.type="mindmap_node";d(this,t)}async sync(){return this.nodeView=je(this.nodeView),super.sync()}async add(e){this.childrenIds.push(e.id),await this.sync();let[t]=await w({id:e.id},this[s],b);return d(e,t),e}async getChildren(){let e=this.childrenIds;return e.length===0?[]:w({id:e},this[s],b)}};o(N,"MindmapNode");var Q=class{constructor(e){this.type="mindmap_node";d(this,e)}};o(Q,"MindmapNodeCreate");var B=class{constructor(e,t){this.type="tag";this.title="";this.color=Z.Red;l(this,s,e),d(this,t)}async sync(){return this[s].exec("WIDGET_UPDATE",this).then(e=>{d(this,e)})}};o(B,"TagEntity");function g(r,e){switch(e.type){case"text":return new _(r,e);case"sticky_note":return new I(r,e);case"shape":return new D(r,e);case"image":return new A(r,e);case"frame":return new M(r,e);case"preview":return new O(r,e);case"card":return new S(r,e);case"app_card":return new R(r,e);case"embed":return new k(r,e);case"connector":return new F(r,e);case"tag":return new B(r,e);case"document":case"mockup":case"curve":case"webscreen":case"usm":case"mindmap":case"kanban":case"table":case"svg":case"emoji":case"mindmap_node":default:return new V(r,e)}}o(g,"convertToSdkFormat");function b(r,e){switch(e.type){case"shape":return new x(r,e);case"mindmap_node":return new N(r,e);default:return g(r,e)}}o(b,"convertToSdkFormatExperimental");var Xe="custom:",ge=o(r=>r.startsWith(Xe),"isCustomEvent"),T=class{constructor(e){this.commander=e;this.subscriptionsMap=new Map}async subscribe(e,t,n){this.addInternalHandler(e,t,n),this.commander.hasEventSubscriptions(e)||await this.commander.exec("UI_REGISTER_EVENT",{name:e}),this.commander.subscribe(e,n)}async unsubscribe(e,t){let n=this.subscriptionsMap.get(e),a=n?.get(t);!n||!a||(n.delete(t),this.commander.unsubscribe(e,a),this.commander.hasEventSubscriptions(e)||await this.commander.exec("UI_UNREGISTER_EVENT",{name:e}))}getInternalHandler(e,t){return this.subscriptionsMap.get(e)?.get(t)}addInternalHandler(e,t,n){this.subscriptionsMap.has(e)||this.subscriptionsMap.set(e,new Map),this.subscriptionsMap.get(e)?.set(t,n)}};o(T,"AppManager");var $e=["drag","drop","dragend","dragstart"],ze={"pointer-events":"none","user-select":"none","-webkit-user-select":"none","-webkit-touch-callout":"none"},te=class{constructor(){this.listeners=[];this.originalBodyStyle={};this.dragStartPosition={x:-1/0,y:-1/0}}setDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}shouldDispatchDrag(e,t){return Math.abs(e-this.dragStartPosition.x)>te.DRAG_THRESHOLD||Math.abs(t-this.dragStartPosition.y)>te.DRAG_THRESHOLD}resetDragging(){throw new Error("Not implemented")}addListener(e,t,n){this.listeners.push({type:e,selector:t,handler:n})}removeListener(e,t,n){this.listeners=this.listeners.filter(a=>a.type!==e||t!=null&&a.selector!==t||n!=null&&a.handler!==n)}isDraggableElement(e){return!(e instanceof HTMLElement)&&!(e instanceof SVGElement)?!1:this.listeners.some(({selector:t})=>!!e.closest(t))}disableClickEvents(){Object.entries(ze).forEach(([e,t])=>{this.originalBodyStyle[e]=document.body.style.getPropertyValue(e),document.body.style.setProperty(e,t)})}restoreClickEvents(){Object.entries(this.originalBodyStyle).forEach(([e,t])=>{document.body.style.setProperty(e,t)}),this.originalBodyStyle={}}dragEnd(e){this.dispatch("dragend",{target:e,clientX:NaN,clientY:NaN,screenX:NaN,screenY:NaN})}dispatch(e,t){this.listeners.forEach(({selector:n,handler:a,type:i})=>{if(e!==i)return;let p=t.target.closest(n);if(!p)return;let f=new CustomEvent(e,{detail:{...t,target:p,type:e}});a(f)})}},H=te;o(H,"BaseDragSensor"),H.DRAG_THRESHOLD=8;var fe=class extends H{constructor(){super();this.isDragging=!1;this.onMouseDown=o(e=>{let t=e.target;!this.isDraggableElement(t)||(t.setAttribute("draggable","false"),this.target=t,this.setDragStartPosition(e.clientX,e.clientY),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove,{passive:!0}))},"onMouseDown");this.onMouseMove=o(e=>{if(!this.target)return;let{clientX:t,clientY:n,screenX:a,screenY:i}=e;if(!this.isDragging&&!this.shouldDispatchDrag(t,n))return;let p=this.isDragging?"drag":"dragstart";this.isDragging||this.disableClickEvents(),this.isDragging=!0,this.dispatch(p,{target:this.target,clientX:t,clientY:n,screenX:a,screenY:i})},"onMouseMove");this.onMouseUp=o(e=>{if(e.preventDefault(),this.isDragging&&this.target){let{clientX:t,clientY:n,screenX:a,screenY:i}=e;this.dispatch("drop",{target:this.target,clientX:t,clientY:n,screenX:a,screenY:i})}window.requestAnimationFrame(()=>this.resetDragging())},"onMouseUp");this.resetDragging=o(()=>{document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove),this.isDragging&&this.target&&this.dragEnd(this.target),this.target&&this.restoreClickEvents(),this.isDragging=!1,this.target=void 0},"resetDragging");document.addEventListener("mousedown",this.onMouseDown),window.addEventListener("blur",this.resetDragging)}};o(fe,"MouseDragSensor");var Je=100,W=!1;window.addEventListener("touchmove",r=>{!W||r.preventDefault()},{passive:!1});var we=class extends H{constructor(){super();this.onTouchStart=o(e=>{let{target:t}=e;if(!this.isDraggableElement(t))return;let{clientX:n,clientY:a,screenX:i,screenY:p}=e.touches[0];this.setDragStartPosition(n,a),t.setAttribute("draggable","false"),this.target=t,this.tapTimeout=window.setTimeout(()=>{this.startDragging({target:t,clientX:n,clientY:a,screenX:i,screenY:p})},Je),window.addEventListener("touchend",this.onTouchEnd),window.addEventListener("touchcancel",this.resetDragging),window.addEventListener("touchmove",this.resetDragging)},"onTouchStart");this.onTouchMove=o(e=>{if(!this.target)return;let{clientX:t,clientY:n,screenX:a,screenY:i}=e.touches[0];this.dispatch("drag",{target:this.target,clientX:t,clientY:n,screenX:a,screenY:i})},"onTouchMove");this.onTouchEnd=o(e=>{if(W&&this.target){let{clientX:n,clientY:a,screenX:i,screenY:p}=e.changedTouches[0];this.dispatch("dragend",{target:this.target,clientX:n,clientY:a,screenX:i,screenY:p})}window.requestAnimationFrame(()=>this.resetDragging())},"onTouchEnd");this.startDragging=o(e=>{!this.shouldDispatchDrag(e.clientX,e.clientY)||(window.removeEventListener("touchmove",this.resetDragging),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),W=!0,this.disableClickEvents(),this.dispatch("dragstart",e))},"startDragging");this.resetDragging=o(()=>{window.removeEventListener("touchend",this.onTouchEnd),window.removeEventListener("touchcancel",this.resetDragging),window.removeEventListener("touchmove",this.resetDragging),window.removeEventListener("touchmove",this.onTouchMove),W&&this.target&&(this.restoreClickEvents(),this.dragEnd(this.target)),this.target=void 0,W=!1,this.tapTimeout!==void 0&&(clearTimeout(this.tapTimeout),this.tapTimeout=void 0)},"resetDragging");window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("blur",this.resetDragging)}};o(we,"TouchDragSensor");var ee=class{constructor(e){this.touchSensor=new we,this.mouseSensor=new fe,Object.assign(this,e)}addListener(e,t){this.mouseSensor.addListener(e,this.selector,t),this.touchSensor.addListener(e,this.selector,t)}removeListener(e,t){this.mouseSensor.removeListener(e,void 0,t),this.touchSensor.removeListener(e,void 0,t)}reset(){$e.forEach(e=>{this.mouseSensor.removeListener(e),this.touchSensor.removeListener(e)})}resetDragging(){this.mouseSensor.resetDragging(),this.touchSensor.resetDragging()}};o(ee,"DragSensor");var v,_e=o(()=>{v?.reset(),v=new ee({selector:".miro-draggable"})},"initDragSensor");var re="internal:drop",Y=new Set,C=new Map,j;async function Ie(r){let e=r.payload;if(e==null)return;let{x:t,y:n}=e,a={x:t,y:n,target:j};Y.forEach(i=>i(a)),v.resetDragging()}o(Ie,"handleInternalDrop");var Ke=o(r=>async e=>{let{clientX:t,clientY:n,target:a}=e.detail;j=a;let i=j.dataset.dragPreview,p=parseInt(j.dataset.dragPreviewWidth??"",10),f=parseInt(j.dataset.dragPreviewHeight??"",10);await r.exec("UI_DRAG_START",{clientX:t,clientY:n,dragImage:i?{width:p===Number.NaN?void 0:p,height:f===Number.NaN?void 0:f,src:i}:void 0})},"onDragStart"),be,Ze=o(r=>async e=>{if(be)return;be=requestAnimationFrame(()=>{be=void 0});let{clientX:t,clientY:n}=e.detail;await r.exec("UI_DRAG_MOVE",{clientX:t,clientY:n})},"onDrag"),Qe=o(r=>async e=>{let{clientX:t,clientY:n}=e.detail;await r.exec("UI_DRAG_DROP",{clientX:t,clientY:n})},"onDrop"),et=o(r=>async e=>{await r.exec("UI_DRAG_END")},"onDragEnd");async function De(r,e){Y.size==0&&(await r.exec("UI_REGISTER_EVENT",{name:re}),r.subscribe(re,Ie),C.set("dragstart",Ke(r)),C.set("drag",Ze(r)),C.set("dragend",et(r)),C.set("drop",Qe(r)),v.addListener("dragstart",C.get("dragstart")),v.addListener("drag",C.get("drag")),v.addListener("dragend",C.get("drag")),v.addListener("drop",C.get("drop"))),Y.add(e)}o(De,"attachDragAndDropListeners");async function Ae(r,e){Y.delete(e),Y.size===0&&(v.removeListener("dragstart",C.get("dragstart")),v.removeListener("drag",C.get("drag")),v.removeListener("dragend",C.get("drag")),v.removeListener("drop",C.get("drop")),r.unsubscribe(re,Ie),await r.exec("UI_UNREGISTER_EVENT",{name:re}))}o(Ae,"detachDragAndDropListeners");var se=class{constructor(e){l(this,s,e),l(this,h,new T(e))}async openPanel(e){await this[s].exec("UI_OPEN_PANEL",e)}async closePanel(){await this[s].exec("UI_CLOSE_PANEL")}async openModal(e){await this[s].exec("UI_OPEN_MODAL",e)}async closeModal(){await this[s].exec("UI_CLOSE_MODAL")}on(e,t){switch(e){case"drop":return De(this[s],t),Promise.resolve();case"icon:click":return this[h].subscribe(e,t,async()=>t());case"app_card:open":return this[h].subscribe(e,t,async n=>{let{appCard:a}=n.payload,i={appCard:g(this[s],a)};t(i)});case"app_card:connect":return this[h].subscribe(e,t,async n=>{let{appCard:a}=n.payload,i={appCard:g(this[s],a)};t(i)});case"selection:update":return this[h].subscribe(e,t,async n=>{let{items:a}=n.payload,i={items:a.map(p=>g(this[s],p))};t(i)});case"online_users:update":return this[h].subscribe(e,t,async n=>{let a=n.payload;t(a)});case"items:create":return this[h].subscribe(e,t,async n=>{let{items:a}=n.payload,i={items:a.map(p=>g(this[s],p))};t(i)});case"experimental:items:update":return this[h].subscribe(e,t,async n=>{let{items:a}=n.payload,i={items:a.map(p=>g(this[s],p))};t(i)});case"items:delete":return this[h].subscribe(e,t,async n=>{let{items:a}=n.payload,i={items:a.map(p=>g(this[s],p))};t(i)});case"experimental:timer:start":case"experimental:timer:update":case"experimental:timer:finish":return this[h].subscribe(e,t,async n=>{t(n.payload)});default:if(ge(e)){let n=o(async a=>{let{items:i}=a.payload,p={items:i.map(f=>g(this[s],f))};t(p)},"internalHandler");return this[h].subscribe(e,t,n)}throw new Error(`unknown event: ${e}`)}}off(e,t){switch(e){case"drop":return Ae(this[s],t),Promise.resolve();case"icon:click":case"app_card:open":case"app_card:connect":case"selection:update":case"online_users:update":case"items:create":case"experimental:items:update":case"items:delete":case"experimental:timer:start":case"experimental:timer:update":case"experimental:timer:finish":return this[h].unsubscribe(e,t);default:if(ge(e))return this[h].unsubscribe(e,t);throw new Error(`unknown event: ${e}`)}}};o(se,"BoardUI");var Se;(function(r){r.Red="red",r.Magenta="magenta",r.Violet="violet",r.LightGreen="light_green",r.Green="green",r.DarkGreen="dark_green",r.Cyan="cyan",r.Blue="blue",r.DarkBlue="dark_blue",r.Yellow="yellow",r.Gray="gray",r.Black="black"})(Se||(Se={}));var Re;(function(r){r.Gray="gray",r.LightYellow="light_yellow",r.Yellow="yellow",r.Orange="orange",r.LightGreen="light_green",r.Green="green",r.DarkGreen="dark_green",r.Cyan="cyan",r.LightPink="light_pink",r.Pink="pink",r.Violet="violet",r.Red="red",r.LightBlue="light_blue",r.Blue="blue",r.DarkBlue="dark_blue",r.Black="black"})(Re||(Re={}));var Me;(function(r){r.Rectangle="rectangle",r.Circle="circle",r.Triangle="triangle",r.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",r.RoundRectangle="round_rectangle",r.Rhombus="rhombus",r.Parallelogram="parallelogram",r.Star="star",r.RightArrow="right_arrow",r.LeftArrow="left_arrow",r.Pentagon="pentagon",r.Hexagon="hexagon",r.Octagon="octagon",r.Trapezoid="trapezoid",r.FlowChartPredefinedProcess="flow_chart_predefined_process",r.LeftRightArrow="left_right_arrow",r.Cloud="cloud",r.LeftBrace="left_brace",r.RightBrace="right_brace",r.Cross="cross",r.Can="can"})(Me||(Me={}));var Oe;(function(r){r.Rectangle="rectangle",r.Circle="circle",r.Triangle="triangle",r.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",r.RoundRectangle="round_rectangle",r.Rhombus="rhombus",r.Parallelogram="parallelogram",r.Star="star",r.RightArrow="right_arrow",r.LeftArrow="left_arrow",r.Pentagon="pentagon",r.Hexagon="hexagon",r.Octagon="octagon",r.Trapezoid="trapezoid",r.FlowChartPredefinedProcess="flow_chart_predefined_process",r.LeftRightArrow="left_right_arrow",r.Cloud="cloud",r.LeftBrace="left_brace",r.RightBrace="right_brace",r.Cross="cross",r.Can="can",r.FlowChartConnector="flow_chart_connector",r.FlowChartMagneticDisk="flow_chart_magnetic_disk",r.FlowChartInputOutput="flow_chart_input_output",r.FlowChartDecision="flow_chart_decision",r.FlowChartDelay="flow_chart_delay",r.FlowChartDisplay="flow_chart_display",r.FlowChartDocument="flow_chart_document",r.FlowChartMagneticDrum="flow_chart_magnetic_drum",r.FlowChartInternalStorage="flow_chart_internal_storage",r.FlowChartManualInput="flow_chart_manual_input",r.FlowChartManualOperation="flow_chart_manual_operation",r.FlowChartMerge="flow_chart_merge",r.FlowChartMultidocument="flow_chart_multidocument",r.FlowChartNoteCurlyLeft="flow_chart_note_curly_left",r.FlowChartNoteCurlyRight="flow_chart_note_curly_right",r.FlowChartNoteSquare="flow_chart_note_square",r.FlowChartOffpageConnector="flow_chart_offpage_connector",r.FlowChartOr="flow_chart_or",r.FlowChartPredefinedProcess2="flow_chart_predefined_process_2",r.FlowChartPreparation="flow_chart_preparation",r.FlowChartProcess="flow_chart_process",r.FlowChartOnlineStorage="flow_chart_online_storage",r.FlowChartSummingJunction="flow_chart_summing_junction",r.FlowChartTerminator="flow_chart_terminator"})(Oe||(Oe={}));var X;(function(r){r.Error="error",r.Info="info"})(X||(X={}));var ne=class{constructor(e){l(this,s,e)}async showInfo(e){let t={message:e,type:X.Info};await this[s].exec("SHOW_NOTIFICATION",t)}async showError(e){let t={message:e,type:X.Error};await this[s].exec("SHOW_NOTIFICATION",t)}async show(e){await this[s].exec("SHOW_NOTIFICATION",e)}};o(ne,"Notifications");var oe=class{constructor(e){l(this,s,e)}async get(){return this[s].exec("VIEWPORT_GET")}async set(e){return this[s].exec("VIEWPORT_SET",e)}async zoomTo(e){return Array.isArray(e)?this[s].exec("VIEWPORT_ZOOM_TO",{items:e.map(t=>t.id)}):this.zoomTo([e])}async getZoom(){return this[s].exec("VIEWPORT_GET_ZOOM")}async setZoom(e){return this[s].exec("VIEWPORT_SET_ZOOM",{zoomLevel:e})}};o(oe,"Viewport");var ke=o((r,e)=>`storage:change:${r}:${e}`,"prefixed"),Ce=class{constructor(e,t){this.name=e;l(this,s,t),l(this,h,new T(t))}async set(e,t){return this[s].exec("STORAGE_SET",{collection:this.name,key:e,value:t})}async get(e){return(await this[s].exec("STORAGE_GET",{collection:this.name,key:e})).value}async remove(e){return this[s].exec("STORAGE_REMOVE",{collection:this.name,key:e})}async onValue(e,t){let n=await this[s].exec("STORAGE_GET",{collection:this.name,key:e});t(n?.value,n?.version);let a=o(async p=>{let{value:f,version:L}=p.payload;return t(f,L)},"internalHandler"),i=ke(this.name,e);return this[h].subscribe(i,t,a)}async offValue(e,t){let n=ke(this.name,e);return this[h].unsubscribe(n,t)}};o(Ce,"Collection");var ae=class{constructor(e){l(this,s,e)}collection(e){return new Ce(e,this[s])}};o(ae,"Storage");async function E(r,e){let t=xe(r),n=await e.exec("WIDGET_CREATE",t);return d(r,n),r}o(E,"add");var ie=class{constructor(e,t){l(this,s,e),this.ui=new se(e),this.notifications=new ne(e),this.viewport=new oe(e),this.storage=new ae(e),this.experimental=t}async createCard(e){return E(new S(this[s],e),this[s])}async createAppCard(e){return E(new R(this[s],e),this[s])}async createFrame(e){return E(new M(this[s],e),this[s])}async createImage(e){return E(new A(this[s],e),this[s])}async createPreview(e){return E(new O(this[s],e),this[s])}async createShape(e){return E(new D(this[s],e),this[s])}async createStickyNote(e){return E(new I(this[s],e),this[s])}async createText(e){return E(new _(this[s],e),this[s])}async createEmbed(e){return E(new k(this[s],e),this[s])}async createConnector(e){return E(new F(this[s],e),this[s])}async createTag(e){return E(new B(this[s],e),this[s])}async sync(e){return e.sync()}async remove(e){let{id:t,type:n}=e;await this[s].exec("WIDGET_REMOVE",{id:t,type:n})}async bringToFront(e){return Array.isArray(e)?this[s].exec("BRING_TO_FRONT",{items:e.map(t=>t.id)}):this.bringToFront([e])}async sendToBack(e){return Array.isArray(e)?this[s].exec("SEND_TO_BACK",{items:e.map(t=>t.id)}):this.sendToBack([e])}async bringInFrontOf(e,t){return Array.isArray(e)?this[s].exec("BRING_IN_FRONT_OF",{items:e.map(n=>n.id),targetId:t.id}):this.bringInFrontOf([e],t)}async sendBehindOf(e,t){return Array.isArray(e)?this[s].exec("SEND_BEHIND_OF",{items:e.map(n=>n.id),targetId:t.id}):this.sendBehindOf([e],t)}async getLayerIndex(e){return e.getLayerIndex()}async getById(e){let t=await this.get({id:e});if(Array.isArray(t)&&t.length)return g(this[s],t[0]);throw new Error(`Can not retrieve item with id ${e}`)}async get(e){return w(e,this[s],g)}async getInfo(){return this[s].exec("GET_BOARD_INFO")}async getUserInfo(){return this[s].exec("GET_USER_INFO")}async getSelection(){return(await this[s].exec("GET_SELECTION")).map(t=>g(this[s],t))}async getOnlineUsers(){return this[s].exec("GET_ONLINE_USERS")}async select(e){return(await this[s].exec("SELECT_WIDGETS",e)).map(n=>g(this[s],n))}async deselect(e){return(await this[s].exec("DESELECT_WIDGETS",e)).map(n=>g(this[s],n))}async getAppData(e){return this[s].exec("GET_BOARD_APP_DATA",{key:e})}async setAppData(e,t){return this[s].exec("SET_BOARD_APP_DATA",{key:e,value:t})}async setMetadata(e,t,n){return e.setMetadata(t,n)}async getMetadata(e,t){return e.getMetadata(t)}async goToLink(e){return e.goToLink()}async getIdToken(){return this[s].exec("GET_ID_TOKEN")}};o(ie,"Board");var me=class{constructor(e){l(this,s,e)}async start(e){let t={duration:e};await this[s].exec("TIMER_START",t)}async stop(){return this[s].exec("TIMER_STOP")}async pause(){return this[s].exec("TIMER_PAUSE")}async resume(){return this[s].exec("TIMER_RESUME")}async prolong(e){let t={duration:e};return this[s].exec("TIMER_PROLONG",t)}async isStarted(){return this[s].exec("TIMER_IS_STARTED")}};o(me,"Timer");var de=class{constructor(e){l(this,s,e)}async follow(e,t){let n={followee:e,...t};await this[s].exec("ATTENTION_FOLLOW",n)}async isFollowing(){return this[s].exec("ATTENTION_IS_FOLLOWING")}async getFollowedUser(){return this[s].exec("ATTENTION_GET_FOLLOWED_USER")}async unfollow(){await this[s].exec("ATTENTION_UNFOLLOW")}};o(de,"Attention");var pe=class{constructor(e){l(this,s,e)}async register(e){return this[s].exec("CUSTOM_ACTION_REGISTER",e)}async deregister(e){await this[s].exec("CUSTOM_ACTION_DEREGISTER",e)}};o(pe,"CustomActionManagement");var Fe=o(r=>`experimental:realtime_event:${r}`,"prefixed"),le=class{constructor(e){l(this,s,e),l(this,h,new T(e))}async broadcast(e,t){await this[s].exec("SEND_REALTIME_BROADCAST_EVENT",{event:e,payload:t})}on(e,t){let n=o(async i=>{t(i.payload)},"internalHandler"),a=Fe(e);return this[h].subscribe(a,t,n)}off(e,t){let n=Fe(e);return this[h].unsubscribe(n,t)}};o(le,"RealtimeEvents");var ce=class{constructor(e){l(this,s,e),this.attention=new de(e),this.timer=new me(e),this.action=new pe(e),this.events=new le(e)}async createMindmapNode(e){let t=await this[s].exec("WIDGET_CREATE",new Q(e));return new N(this[s],t)}async createShape(e){let t=await this[s].exec("WIDGET_CREATE",new x(this[s],e));return new x(this[s],t)}async get(e){return w(e,this[s],b)}async select(e){return(await this[s].exec("SELECT_WIDGETS",e)).map(n=>b(this[s],n))}async deselect(e){return(await this[s].exec("DESELECT_WIDGETS",e)).map(n=>b(this[s],n))}async getSelection(){return(await this[s].exec("GET_SELECTION")).map(t=>b(this[s],t))}async getVotingResults(){return this[s].exec("GET_VOTING_RESULTS")}async sync(e){return e.sync()}async remove(e){let{id:t,type:n}=e;await this[s].exec("WIDGET_REMOVE",{id:t,type:n})}async findEmptySpace(e){return this[s].exec("FIND_EMPTY_SPACE",e)}};o(ce,"Experimental");var Ne="1.53475.0",ve=new q({clientWindow:window}),tt=new U(ve,"experimental"),rt=new ce(tt),st=new ie(ve,rt);ve.exec("handshake",{clientVersion:Ne});_e();new URLSearchParams(location.search).has("autotest")&&console.log("SDKv2 loaded for client version: 1.53475.0 and git commit: aabd1ff11d7c61858793e068918b8bfdaf0bb29f");return nt;})();
